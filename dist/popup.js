(()=>{"use strict";document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("actionButton"),t=document.getElementById("previewImage"),n=document.getElementById("loading"),o=document.getElementById("error"),s=document.getElementById("noPreview");let l=!0;function r(e){n.style.display="none",o.textContent=e,o.style.display="block",s.style.display="block",t.style.display="none"}e.addEventListener("click",(()=>{l?(n.style.display="block",o.style.display="none",s.style.display="none",t.style.display="none",chrome.tabs.query({active:!0,currentWindow:!0},(o=>{var d,a;(null===(d=o[0])||void 0===d?void 0:d.id)?chrome.tabs.captureVisibleTab(null!==(a=o[0].windowId)&&void 0!==a?a:chrome.windows.WINDOW_ID_CURRENT,{format:"png"},(o=>{chrome.runtime.lastError?r(chrome.runtime.lastError.message||"Unknown error"):o&&(t.src=o,t.onload=()=>{n.style.display="none",t.style.display="block",s.style.display="none",l=!1,e.textContent="Screenshot",e.classList.add("screenshot")})})):r("No active tab found")}))):t.src?chrome.downloads.download({url:t.src,filename:"screenshot.png"},(()=>{chrome.runtime.lastError?r(chrome.runtime.lastError.message||"Download failed"):(l=!0,e.textContent="Preview",e.classList.remove("screenshot"),t.style.display="none",s.style.display="block")})):r("No screenshot to download")}))}))})();